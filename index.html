<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Philosopher's Cipher</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Lora:ital@1&display=swap');

        body {
            background-color: #000000;
            color: #f0f0f0;
            font-family: 'Lora', serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            text-align: center;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            width: 100%;
        }

        h1 {
            font-family: 'Cinzel', serif;
            font-size: 3em;
            color: #8B0000;
            margin-bottom: 40px;
            letter-spacing: 2px;
        }

        audio {
            width: 80%;
            max-width: 500px;
            margin: 0 auto 30px auto;
            display: block;
        }

        /* Custom Audio Player Styles */
        audio::-webkit-media-controls-panel {
            background-color: #f0f0f0;
        }

        audio::-webkit-media-controls-play-button {
            background-color: #dcdcdc;
            border-radius: 50%;
        }

        audio::-webkit-media-controls-current-time-display,
        audio::-webkit-media-controls-time-remaining-display {
            color: #000;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 40px;
        }

        .button {
            background-color: #8B0000;
            color: #ffffff;
            border: none;
            padding: 15px 30px;
            font-size: 1em;
            font-family: 'Cinzel', serif;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .button:hover {
            background-color: #A52A2A;
        }

        .hint-content {
            display: none;
            margin-top: 20px;
            font-size: 1.1em;
            font-style: italic;
            color: #aaa;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
        }

        .download-link {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>THE PHILOSOPHER'S CIPHER</h1>

        <audio id="audioPlayer" controls>
            <source src="audio.wav" type="audio/wav">
            Your browser does not support the audio element.
        </audio>

        <div class="controls">
            <button class="button" id="playBtn">PLAY</button>
            <a href="audio.wav" download="audio.wav" class="download-link" id="downloadLink"></a>
            <button class="button" id="downloadBtn">DOWNLOAD</button>
            <button class="button" id="hintBtn">REVEAL HINT</button>
        </div>

        <div class="hint-content" id="hintContent">
            <p><strong>Hint:</strong> May be you’ll need to decrypt this first to uncover the hidden message.
Once it’s revealed, follow the riddle carefully—it holds the next step.
Listen closely to the audio file after decryption; within its layers lies your clue.
Only by decoding the sound will you discover what must be done next.</p>
        </div>
    </div>

    <script>
        const audioPlayer = document.getElementById('audioPlayer');
        const playBtn = document.getElementById('playBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const downloadLink = document.getElementById('downloadLink');
        const hintBtn = document.getElementById('hintBtn');
        const hintContent = document.getElementById('hintContent');
        const isFileProtocol = window.location.protocol === 'file:';

        // Play button functionality
        playBtn.addEventListener('click', () => {
            if (audioPlayer.paused) {
                audioPlayer.play();
                playBtn.textContent = 'PAUSE';
            } else {
                audioPlayer.pause();
                playBtn.textContent = 'PLAY';
            }
        });
        
        audioPlayer.addEventListener('ended', () => {
             playBtn.textContent = 'PLAY';
        });


        // Download button functionality
        downloadBtn.addEventListener('click', () => {
            if (isFileProtocol) {
                downloadLink.click();
            } else {
                downloadBtn.textContent = 'DOWNLOADING...';
                downloadBtn.disabled = true;

                fetch('audio.wav')
                    .then(response => response.blob())
                    .then(blob => {
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.style.display = 'none';
                        a.href = url;
                        a.download = 'audio.wav';
                        document.body.appendChild(a);
                        a.click();
                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(a);
                    })
                    .catch(() => downloadLink.click())
                    .finally(() => {
                         downloadBtn.textContent = 'DOWNLOAD';
                         downloadBtn.disabled = false;
                    });
            }
        });

        // Reveal Hint functionality
        hintBtn.addEventListener('click', () => {
            hintContent.style.display = 'block';
        });
    </script>
</body>
</html>
